axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = c(11.6401, 40.77548),ylim = NULL)#+
ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = c(11.6401, 40.77548),ylim = NULL)#+
#annotate("text",x=33, y=-33, label= fff)#+
#annotate("text",x=33, y=-33, label= fff)
p8<- ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
+xlim(c(20,40))
p8<- ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
xlim(c(20,40))
ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
xlim(c(20,40))
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = c(11.6401, 40.77548),ylim = NULL)+
xlim(c(20,40))#+
ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = c(11.6401, 40.77548),ylim = NULL)+
xlim(c(20,40))#+
ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = c(11.6401, 40.77548),ylim = NULL)
ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = c(11.6401, 40.77548),ylim = NULL)+
ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = c(15, 40.77548),ylim = NULL)+
ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = c(15, 40.77548),ylim = NULL)
ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = c(15, 40.77548),ylim = NULL)
p8<- ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = c(40.77548,15),ylim = NULL)
p8<- ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = NULL,ylim = c(-34.81917,-4.438023  ))
ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = NULL,ylim = c(-34.81917,-4.438023  ))
library(png)
library(magick)
library(readxl)
library(ragg)
library(ggpubr)
library(gridExtra)
library(raster)
library(ggplot2)
setwd("C:/Users/eerdo/OneDrive - University of Leeds/PROJ_FORECAST/output_MODIS")
list<-list.files("C:/Users/eerdo/OneDrive - University of Leeds/PROJ_FORECAST/output_MODIS",pattern=".tif")
#dates<-c("01_2014-01-01","04_2014-04-01","07_2014-07-01","10_2014-10-01",
#        "01_2015-01-01","04_2015-04-01","07_2015-07-01","10_2015-10-01")
dates<-c("2015-01-01","2015-04-01","2015-07-01","2015-10-01",
"2016-01-01","2016-04-01","2016-07-01","2016-10-01")
#name<-"_1_breeding_REDUCEDELV_abundance_BRT_MODIS.tif"
name<-"_1_roosting_REDUCEDELVPREC_abundance_BRT_MODIS.tif"
list<-paste0(dates,name)
name2<-"_1_breeding_REDUCEDELV_abundance_BRT_MODIS.tif"
#name2<-"_1_roosting_REDUCEDELVPREC_abundance_BRT_MODIS.tif"
list2<-paste0(dates,name2)
# Final Forecast Code
library(magrittr)
library(readr)
library(pROC)
library(raster)
library(rnaturalearth)
library(rnaturalearthdata)
library(matrixStats)
library(lubridate)
library(gbm)
southernafrica<-ne_countries(country=c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),scale = "small", returnclass = "sp")
fff<-list[1]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc <- crop(ra, e)
rc<-crop(rc,southernafrica)
rc<-mask(rc,southernafrica)
rc<-log10(rc)-1
rc<-10^(rc-1)
fff<-list2[1]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc2 <- crop(ra, e)
rc2<-crop(rc2,southernafrica)
rc2<-mask(rc2,southernafrica)
rc2<-log10(rc2)-1
rc2<-10^(rc2-1)
rc<-rc+rc2
rrrrr<-as.data.frame(rasterToPoints(rc))
colnames(rrrrr)<-c("x","y","var")
absent<-na.omit(rrrrr[rrrrr$var==0,])
present<-na.omit(rrrrr[rrrrr$var>0,])
present$var<-present$var
data<-rbind(absent,present)
rasterr<-rasterFromXYZ(data)
rrrrr<-as.data.frame(rasterToPoints(rasterr))
colnames(rrrrr)<-c("x","y","var")
rrrrr$var<-log10(1+rrrrr$var)
#rrrrr$var<-as.numeric(data2)-1
max(rrrrr$var)
p1<-ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1), colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = NULL,ylim = c(-34.81917,-4.438023  ))
#annotate("text",x=33, y=-33, label= fff)
fff<-list[5]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc <- crop(ra, e)
rc<-crop(rc,southernafrica)
rc<-mask(rc,southernafrica)
rc<-log10(rc)-1
rc<-10^(rc-1)
fff<-list2[5]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc2 <- crop(ra, e)
rc2<-crop(rc2,southernafrica)
rc2<-mask(rc2,southernafrica)
rc2<-log10(rc2)-1
rc2<-10^(rc2-1)
rc<-rc+rc2
rrrrr<-as.data.frame(rasterToPoints(rc))
colnames(rrrrr)<-c("x","y","var")
absent<-na.omit(rrrrr[rrrrr$var==0,])
present<-na.omit(rrrrr[rrrrr$var>0,])
present$var<-present$var
data<-rbind(absent,present)
rasterr<-rasterFromXYZ(data)
rrrrr<-as.data.frame(rasterToPoints(rasterr))
colnames(rrrrr)<-c("x","y","var")
rrrrr$var<-log10(1+rrrrr$var)
#rrrrr$var<-as.numeric(data2)-1
max(rrrrr$var)
p2<- ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = NULL,ylim = c(-34.81917,-4.438023  ))
#annotate("text",x=33, y=-33, label= fff)#+
#annotate("text",x=33, y=-33, label= fff)
# scale_fill_gradientn(name="Distribution suitability",colours = c("lightgrey","darkgrey","#FFF5BE","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))
fff<-list[2]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc <- crop(ra, e)
rc<-crop(rc,southernafrica)
rc<-mask(rc,southernafrica)
rc<-log10(rc)-1
rc<-10^(rc-1)
fff<-list2[2]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc2 <- crop(ra, e)
rc2<-crop(rc2,southernafrica)
rc2<-mask(rc2,southernafrica)
rc2<-log10(rc2)-1
rc2<-10^(rc2-1)
rc<-rc+rc2
rrrrr<-as.data.frame(rasterToPoints(rc))
colnames(rrrrr)<-c("x","y","var")
absent<-na.omit(rrrrr[rrrrr$var==0,])
present<-na.omit(rrrrr[rrrrr$var>0,])
present$var<-present$var
data<-rbind(absent,present)
rasterr<-rasterFromXYZ(data)
rrrrr<-as.data.frame(rasterToPoints(rasterr))
colnames(rrrrr)<-c("x","y","var")
rrrrr$var<-log10(1+rrrrr$var)
#rrrrr$var<-as.numeric(data2)-1
max(rrrrr$var)
p3<- ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1), colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = NULL,ylim = c(-34.81917,-4.438023  ))
#annotate("text",x=33, y=-33, label= fff)#+
#annotate("text",x=33, y=-33, label= fff)
fff<-list[6]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc <- crop(ra, e)
rc<-crop(rc,southernafrica)
rc<-mask(rc,southernafrica)
rc<-log10(rc)-1
rc<-10^(rc-1)
fff<-list2[6]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc2 <- crop(ra, e)
rc2<-crop(rc2,southernafrica)
rc2<-mask(rc2,southernafrica)
rc2<-log10(rc2)-1
rc2<-10^(rc2-1)
rc<-rc+rc2
rrrrr<-as.data.frame(rasterToPoints(rc))
colnames(rrrrr)<-c("x","y","var")
absent<-na.omit(rrrrr[rrrrr$var==0,])
present<-na.omit(rrrrr[rrrrr$var>0,])
present$var<-present$var
data<-rbind(absent,present)
rasterr<-rasterFromXYZ(data)
rrrrr<-as.data.frame(rasterToPoints(rasterr))
colnames(rrrrr)<-c("x","y","var")
rrrrr$var<-log10(1+rrrrr$var)
#rrrrr$var<-as.numeric(data2)-1
max(rrrrr$var)
p4<- ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1), colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = NULL,ylim = c(-34.81917,-4.438023  ))
#annotate("text",x=33, y=-33, label= fff)#+
#annotate("text",x=33, y=-33, label= fff)
fff<-list[3]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc <- crop(ra, e)
rc<-crop(rc,southernafrica)
rc<-mask(rc,southernafrica)
rc<-log10(rc)-1
rc<-10^(rc-1)
fff<-list2[3]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc2 <- crop(ra, e)
rc2<-crop(rc2,southernafrica)
rc2<-mask(rc2,southernafrica)
rc2<-log10(rc2)-1
rc2<-10^(rc2-1)
rc<-rc+rc2
rrrrr<-as.data.frame(rasterToPoints(rc))
colnames(rrrrr)<-c("x","y","var")
absent<-na.omit(rrrrr[rrrrr$var==0,])
present<-na.omit(rrrrr[rrrrr$var>0,])
present$var<-present$var
data<-rbind(absent,present)
rasterr<-rasterFromXYZ(data)
rrrrr<-as.data.frame(rasterToPoints(rasterr))
colnames(rrrrr)<-c("x","y","var")
rrrrr$var<-log10(1+rrrrr$var)
#rrrrr$var<-as.numeric(data2)-1
max(rrrrr$var)
p5<-   ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1), colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = NULL,ylim = c(-34.81917,-4.438023  ))
#annotate("text",x=33, y=-33, label= fff)#+
#annotate("text",x=33, y=-33, label= fff)
fff<-list[7]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc <- crop(ra, e)
rc<-crop(rc,southernafrica)
rc<-mask(rc,southernafrica)
rc<-log10(rc)-1
rc<-10^(rc-1)
fff<-list2[7]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc2 <- crop(ra, e)
rc2<-crop(rc2,southernafrica)
rc2<-mask(rc2,southernafrica)
rc2<-log10(rc2)-1
rc2<-10^(rc2-1)
rc<-rc+rc2
rrrrr<-as.data.frame(rasterToPoints(rc))
colnames(rrrrr)<-c("x","y","var")
absent<-na.omit(rrrrr[rrrrr$var==0,])
present<-na.omit(rrrrr[rrrrr$var>0,])
present$var<-present$var
data<-rbind(absent,present)
rasterr<-rasterFromXYZ(data)
rrrrr<-as.data.frame(rasterToPoints(rasterr))
colnames(rrrrr)<-c("x","y","var")
rrrrr$var<-log10(1+rrrrr$var)
#rrrrr$var<-as.numeric(data2)-1
max(rrrrr$var)
p6<- ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = NULL,ylim = c(-34.81917,-4.438023  ))
#annotate("text",x=33, y=-33, label= fff)#+
#annotate("text",x=33, y=-33, label= fff)
fff<-list[4]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc <- crop(ra, e)
rc<-crop(rc,southernafrica)
rc<-mask(rc,southernafrica)
rc<-log10(rc)-1
rc<-10^(rc-1)
fff<-list2[4]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc2 <- crop(ra, e)
rc2<-crop(rc2,southernafrica)
rc2<-mask(rc2,southernafrica)
rc2<-log10(rc2)-1
rc2<-10^(rc2-1)
rc<-rc+rc2
rrrrr<-as.data.frame(rasterToPoints(rc))
colnames(rrrrr)<-c("x","y","var")
absent<-na.omit(rrrrr[rrrrr$var==0,])
present<-na.omit(rrrrr[rrrrr$var>0,])
present$var<-present$var
data<-rbind(absent,present)
rasterr<-rasterFromXYZ(data)
rrrrr<-as.data.frame(rasterToPoints(rasterr))
colnames(rrrrr)<-c("x","y","var")
rrrrr$var<-log10(1+rrrrr$var)
#rrrrr$var<-as.numeric(data2)-1
max(rrrrr$var)
p7<-  ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = NULL,ylim = c(-34.81917,-4.438023  ))
#annotate("text",x=33, y=-33, label= fff)#+
#annotate("text",x=33, y=-33, label= fff)
fff<-list[8]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc <- crop(ra, e)
rc<-crop(rc,southernafrica)
rc<-mask(rc,southernafrica)
rc<-log10(rc)-1
rc<-10^(rc-1)
fff<-list2[8]
ra<-raster(paste0(fff))
e <- extent(10, 40, -38, -5)
rc2 <- crop(ra, e)
rc2<-crop(rc2,southernafrica)
rc2<-mask(rc2,southernafrica)
rc2<-log10(rc2)-1
rc2<-10^(rc2-1)
rc<-rc+rc2
rrrrr<-as.data.frame(rasterToPoints(rc))
colnames(rrrrr)<-c("x","y","var")
absent<-na.omit(rrrrr[rrrrr$var==0,])
present<-na.omit(rrrrr[rrrrr$var>0,])
present$var<-present$var
data<-rbind(absent,present)
rasterr<-rasterFromXYZ(data)
rrrrr<-as.data.frame(rasterToPoints(rasterr))
colnames(rrrrr)<-c("x","y","var")
rrrrr$var<-log10(1+rrrrr$var)
#rrrrr$var<-as.numeric(data2)-1
max(rrrrr$var)
p8<- ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(limits=c(0,5), breaks=seq(0,5, by = 1),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())+
borders(database = "world",regions = c('South Africa', 'Botswana','Lesotho', 'Swaziland','Mozambique','Namibia'
,'Zimbabwe','Angola','Zambia','Malawi'),fill = NA,colour = "grey50",xlim = NULL,ylim = c(-34.81917,-4.438023  ))
#annotate("text",x=33, y=-33, label= fff)#+
#annotate("text",x=33, y=-33, label= fff)
setwd("C:/Users/eerdo/Desktop/FinalDynamicSDM")
png(file='Quelea_Combo_Abundance_sorteddscale_15_16.png', width=6400, height=12000, res=1200)
grid.arrange(p1,p2,
p3,p4,
p5,p6,
p7,p8, nrow = 4,ncol=2)
dev.off()
setwd("C:/Users/eerdo/Desktop/FinalDynamicSDM")
png(file='Quelea_Combo_Abundance_Legend.png', width=6400, height=12000, res=1200)
ggplot(data = rrrrr) +
geom_raster(aes(x = x, y = y, fill = var))+
scale_fill_gradientn(name = " ",limits=c(0,5), breaks=seq(0,5, by = 1),labels= c(0,scales::comma(10^1),scales::comma(10^2),scales::comma(10^3),scales::comma(10^4),scales::comma(10^5)),colours = c("#E8E8E8","darkgrey","#FCF5C5","#FFF5BE","#ED8E07","#cc0000","#660000"),guide=guide_colourbar(reverse = TRUE))+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),legend.text = element_text(size=20),legend.key.size = unit(2, 'cm'),
panel.background = element_rect(fill = "white", color = "white"),
axis.line=element_blank(),axis.ticks=element_blank(),axis.text=element_blank())
dev.off()
use_github_action_check_standard(
save_as = "R-CMD-check.yaml",
ref = NULL,
ignore = TRUE,
open = FALSE
)
usethis::use_github_action_check_standard(
save_as = "R-CMD-check.yaml",
ref = NULL,
ignore = TRUE,
open = FALSE
)
usethis::use_github_action_check_standard(
save_as = "R-CMD-check.yaml"
)
