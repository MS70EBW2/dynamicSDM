<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>dynamicSDM: Response variable data • dynamicSDM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="dynamicSDM: Response variable data">
<meta property="og:description" content="dynamicSDM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dynamicSDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vig0.html">vig0</a>
    </li>
    <li>
      <a href="../articles/vignette1_response_data.html">dynamicSDM: Response variable data</a>
    </li>
    <li>
      <a href="../articles/vignette2_explanatory_data.html">dynamicSDM: Explanatory variable data</a>
    </li>
    <li>
      <a href="../articles/vignette3_modelling.html">dynamicSDM: model fitting and autocorrelation</a>
    </li>
    <li>
      <a href="../articles/vignette4_projecting.html">dynamicSDM: dynamic distribution projections</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>dynamicSDM: Response variable data</h1>
            
      
      
      <div class="hidden name"><code>vignette1_response_data.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>dynamicSDM offers novel tools for developing species geographical distribution and abundance modelling (SDM) at high spatiotemporal resolution. Across the dynamicSDM vignettes, we demonstrate package functions on a case study species and guide users through the four key species distribution modelling stages:</p>
<ul>
<li>Stage 1: Organising response variable data including species occurrence and pseudo-absence records</li>
<li>Stage 2: Extracting spatiotemporally-buffered explanatory variables</li>
<li>Stage 3: Fitting SDMs whilst accounting for spatial and temporal autocorrelation</li>
<li>Stage 4: Projecting intra- and inter- annual geographical distributions and abundances at high spatiotemporal resolution.</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Before starting this tutorial, the dynamicSDM package needs to be installed. You can install the latest version from <a href="https://github.com/r-a-dobson/dynamicSDM" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::install_github('r-a-dobson/dynamicSDM')</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">dynamicSDM</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/" class="external-link">sp</a></span><span class="op">)</span></span></code></pre></div>
<p>Due to the utilisation of Google Earth Engine and Google Drive across dynamicSDM functions, you must also set up a free Google account at <a href="https://www.google.com/account/about/" class="external-link">Google</a>. Once you have your Google log-in details, these can be used to authorise Google Earth Engine in the rgee package and Google Drive in the googledrive package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/rgee/" class="external-link">rgee</a></span><span class="op">)</span></span>
<span><span class="co">#rgee::ee_install()</span></span>
<span><span class="fu">rgee</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/rgee/reference/ee_check-tools.html" class="external-link">ee_check</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://googledrive.tidyverse.org" class="external-link">googledrive</a></span><span class="op">)</span></span>
<span><span class="co">#googledrive::drive_auth_configure()</span></span>
<span><span class="fu">googledrive</span><span class="fu">::</span><span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_user.html" class="external-link">drive_user</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="directory-organisation">Directory organisation<a class="anchor" aria-label="anchor" href="#directory-organisation"></a>
</h2>
<p>As we continue through the species distribution modelling framework, functions will generate a range of outputs. To keep organised, we recommend a structured directory system. The code below will create a new project directory in your temporary folders, but you can edit the script to specify your home directory if you want to retain function outputs between R sessions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">project_directory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"dynamicSDM_vignette"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># project_directory&lt;-"your_path_here"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">project_directory</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="case-study-the-red-billed-quelea">Case study: the red-billed quelea<a class="anchor" aria-label="anchor" href="#case-study-the-red-billed-quelea"></a>
</h2>
<p>In this four stage tutorial, we will be studying the case study species, the red-billed quelea (Quelea quelea), a nomadic bird inhabiting sub-Saharan Africa. With highly variable distributions driven by short-term weather and resource availability, <em>dynamicSDM</em> provides key functions to accurately model quelea’s distribution through space and time.</p>
</div>
<div class="section level2">
<h2 id="stage-1-response-variable-data">Stage 1: Response variable data<a class="anchor" aria-label="anchor" href="#stage-1-response-variable-data"></a>
</h2>
<p>In this tutorial, we will be processing a sample of species occurrence records for the red-billed quelea (Quelea quelea) to generate an SDM response variable data frame. This will involve filtering records by spatiotemporal quality, extent and resolution; testing and accounting for spatiotemporal biases in records, and generating pseudo-absences through space and time.</p>
<div class="section level3">
<h3 id="a-import-occurrence-records">a) Import occurrence records<a class="anchor" aria-label="anchor" href="#a-import-occurrence-records"></a>
</h3>
<p>A sample of red-billed quelea occurrence data can be loaded into your local R environment using the code below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sample_occ_data"</span><span class="op">)</span></span></code></pre></div>
<p>These records are formatted as exported from the Global Biodiversity Information Facility, with columns labelled “decimalLongitude” and “decimalLatitude”. For dynamicSDM functions, occurrence data must be in a specific format; containing numeric data in columns labelled “x” and “y” for the record co-ordinates longitude and latitude, and “day”, “month” and “year” for the record’s date.</p>
<p>convert_gbif() can be used to convert between these formats, or this can be achieved manually for data not extracted from GBIF.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_occ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_gbif.html">convert_gbif</a></span><span class="op">(</span><span class="va">sample_occ_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="b-filter-occurrence-records">b) Filter occurrence records<a class="anchor" aria-label="anchor" href="#b-filter-occurrence-records"></a>
</h3>
<div class="section level4">
<h4 id="validity-and-completeness">Validity and completeness<a class="anchor" aria-label="anchor" href="#validity-and-completeness"></a>
</h4>
<p>Species occurrence records may contain anomalous or missing values in the co-ordinates or dates given. spatiotemp_check() can be used to exclude records with missing (NA) values (argument na.handle), invalid co-ordinates (coord.handle), invalid dates (date.handle) and duplicate records (duplicate.handle).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_occ_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spatiotemp_check.html">spatiotemp_check</a></span><span class="op">(</span>occ.data <span class="op">=</span> <span class="va">sample_occ</span>,</span>
<span>                                               na.handle <span class="op">=</span> <span class="st">"exclude"</span>,</span>
<span>                                               date.handle <span class="op">=</span> <span class="st">"exclude"</span>,</span>
<span>                                               date.res <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>                                               coord.handle <span class="op">=</span> <span class="st">"exclude"</span>,</span>
<span>                                               duplicate.handle <span class="op">=</span> <span class="st">"exclude"</span><span class="op">)</span></span>
<span><span class="co">#&gt; omitting any species records with coordinates containing NA</span></span>
<span><span class="co">#&gt; omitting any species records with dates containing NA</span></span>
<span><span class="co">#&gt; omitting any duplicate records</span></span>
<span><span class="co">#&gt; any records with invalid co-ordinates excluded</span></span>
<span><span class="co">#&gt; any records with invalid dates excluded</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sample_occ_filtered</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 311</span></span></code></pre></div>
<p>Additionally, users can opt to take advantage of the CoordinateCleaner package function to exclude records flagged as containing potentially anomalous co-ordinates, based on a wider variety of spatial tests than dynamicSDM alone offers.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_occ_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spatiotemp_check.html">spatiotemp_check</a></span><span class="op">(</span>occ.data <span class="op">=</span> <span class="va">sample_occ</span>,</span>
<span>                                               na.handle <span class="op">=</span> <span class="st">"exclude"</span>,</span>
<span>                                               date.handle <span class="op">=</span> <span class="st">"exclude"</span>,</span>
<span>                                               date.res <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>                                               coord.handle <span class="op">=</span> <span class="st">"exclude"</span>,</span>
<span>                                               duplicate.handle <span class="op">=</span> <span class="st">"exclude"</span>,</span>
<span>                                               CoordClean <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                               CoordClean.species <span class="op">=</span> <span class="st">"quelea"</span>,</span>
<span>                                               CoordClean.handle <span class="op">=</span> <span class="st">"exclude"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="spatiotemporal-extent">Spatiotemporal extent<a class="anchor" aria-label="anchor" href="#spatiotemporal-extent"></a>
</h4>
<p>When generating dynamic species distribution models, it is important that occurrence records match the spatiotemporal extent of the study and any remote-sensing datasets to be utilised as explanatory variables. spatiotemporal_extent() removes any records outside of the set spatiotemporal extents.</p>
<p>In this case study, we want to model the subspecies Q. q. lathamii which is typically limited to southern Africa and we will incorporate remote sensing datasets available for the years 2001 to 2019. To filter records to these extents, we use a polygon of southern African countries, which can be read into your R environment and applied using the following code.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sample_extent_data"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_occ_cropped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spatiotemp_extent.html">spatiotemp_extent</a></span><span class="op">(</span>occ.data <span class="op">=</span> <span class="va">sample_occ_filtered</span>,</span>
<span>                                               temporal.ext <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2001-01-01"</span>, <span class="st">"2018-12-01"</span><span class="op">)</span>,</span>
<span>                                               spatial.ext <span class="op">=</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html" class="external-link">extent</a></span><span class="op">(</span><span class="va">sample_extent_data</span><span class="op">)</span>,</span>
<span>                                               prj <span class="op">=</span> <span class="st">"+proj=longlat +datum=WGS84 +no_defs"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required namespace: sf</span></span>
<span></span>
<span><span class="co">## Lets plot the change</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample_extent_data</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="va">sample_occ_filtered</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                            proj4string <span class="op">=</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +datum=WGS84 +no_defs"</span><span class="op">)</span>,</span>
<span>                            data <span class="op">=</span> <span class="va">sample_occ_filtered</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette1_response_data_files/figure-html/example-spatiotemp_extent-1.png" width="384"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample_extent_data</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="va">sample_occ_cropped</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                            proj4string <span class="op">=</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +datum=WGS84 +no_defs"</span><span class="op">)</span>,</span>
<span>                            data <span class="op">=</span> <span class="va">sample_occ_cropped</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette1_response_data_files/figure-html/example-spatiotemp_extent-2.png" width="384"></p>
</div>
<div class="section level4">
<h4 id="spatiotemporal-resolution">Spatiotemporal resolution<a class="anchor" aria-label="anchor" href="#spatiotemporal-resolution"></a>
</h4>
<p>The spatial resolution of occurrence record co-ordinates and the temporal resolution of occurrence record dates are also important when generating dynamic SDMs. spatiotemp_resolution can filter records by set thresholds.</p>
<p>As quelea migrations are driven by highly local and short-term environmental factors, we will filter to exclude records not given to the specific day and co-ordinates to four decimal places.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_occ_cropped</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/spatiotemp_resolution.html">spatiotemp_resolution</a></span><span class="op">(</span>occ.data <span class="op">=</span> <span class="va">sample_occ_cropped</span>,</span>
<span>                                             spatial.res <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                             temporal.res <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sample_occ_cropped</span><span class="op">)</span> <span class="co"># Even more records have been removed!</span></span>
<span><span class="co">#&gt; [1] 170</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="c-test-for-spatial-and-temporal-sampling-biases">c) Test for spatial and temporal sampling biases<a class="anchor" aria-label="anchor" href="#c-test-for-spatial-and-temporal-sampling-biases"></a>
</h3>
<p>For many reasons, the collection of species occurrence records are biased through space and time. These biases can impact SDM performance by over- or under- representing conditions at a given site or time. spatiotemp_bias() returns the results of statistical tests and plots for visual assessment of such biases.</p>
<p>The code below tests for bias across the entire dataset and species range.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bias_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spatiotemp_bias.html">spatiotemp_bias</a></span><span class="op">(</span>occ.data <span class="op">=</span> <span class="va">sample_occ_cropped</span>,</span>
<span>                                temporal.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span><span class="op">)</span>,</span>
<span>                                plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                spatial.method <span class="op">=</span> <span class="st">"simple"</span>,</span>
<span>                                prj <span class="op">=</span> <span class="st">"+proj=longlat +datum=WGS84"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bias_results</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Temporal_bias_year</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Chi-squared test for given probabilities</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  occ.data.frequency</span></span>
<span><span class="co">#&gt; X-squared = 79.6, df = 15, p-value = 8.265e-11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Spatial_bias</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  min.nndist.actual and min.nndist.random</span></span>
<span><span class="co">#&gt; t = -8.3044, df = 282.32, p-value = 4.222e-15</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -69110.22 -42625.28</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x mean of y </span></span>
<span><span class="co">#&gt;  38757.03  94624.79</span></span></code></pre></div>
<p>Whereas, this code will test for bias across only the core of the species range.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bias_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spatiotemp_bias.html">spatiotemp_bias</a></span><span class="op">(</span>occ.data <span class="op">=</span> <span class="va">sample_occ_cropped</span>,</span>
<span>                                temporal.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span><span class="op">)</span>,</span>
<span>                                plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                spatial.method <span class="op">=</span> <span class="st">"core"</span>,</span>
<span>                                prj <span class="op">=</span> <span class="st">"+proj=longlat +datum=WGS84"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bias_results</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Temporal_bias_year</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Chi-squared test for given probabilities</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  occ.data.frequency</span></span>
<span><span class="co">#&gt; X-squared = 79.6, df = 15, p-value = 8.265e-11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Spatial_bias</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  min.nndist.actual and min.nndist.random</span></span>
<span><span class="co">#&gt; t = -4.3264, df = 193.5, p-value = 2.427e-05</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -24970.343  -9332.462</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x mean of y </span></span>
<span><span class="co">#&gt;  26085.18  43236.59</span></span></code></pre></div>
<p>Both approaches can generate important results. The latter may be a more reliable indicator if the species range is expanding or shifting in response to global change. This is because records at the range periphery that have been collected randomly may still not be evenly distributed through space and time due to underlying ecological processes. Therefore, focusing on species core may be more representative.</p>
</div>
<div class="section level3">
<h3 id="d-account-for-spatial-and-temporal-sampling-biases">d) Account for spatial and temporal sampling biases<a class="anchor" aria-label="anchor" href="#d-account-for-spatial-and-temporal-sampling-biases"></a>
</h3>
<div class="section level4">
<h4 id="occurrence-record-thinning">Occurrence record thinning<a class="anchor" aria-label="anchor" href="#occurrence-record-thinning"></a>
</h4>
<p>One approach to correct spatiotemporal sampling biases are to “thin” records, which involves excluding records that have been collected too closely in space or time. spatiotemp_thin() allows users to specify the spatial and temporal distance to thin records by. An important argument of spatiotemp_thin() is spatial.split.degrees which specifies the size of grid cells to split occurrence records into before temporal thinning. This prevents spatially distant but temporally close records from being filtered out.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">occ_thin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spatiotemp_thin.html">spatiotemp_thin</a></span><span class="op">(</span>occ.data <span class="op">=</span> <span class="va">sample_occ_cropped</span>,</span>
<span>                                   temporal.method <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>                                   temporal.dist <span class="op">=</span> <span class="fl">30</span>,</span>
<span>                                   spatial.split.degrees <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                   spatial.dist <span class="op">=</span> <span class="fl">30000</span>,</span>
<span>                                   iterations <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the difference in spatial distribution after thinning</span></span>
<span></span>
<span><span class="co"># Non-thinned</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample_extent_data</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span></span>
<span><span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="va">sample_occ_cropped</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                    proj4string <span class="op">=</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +datum=WGS84 +no_defs"</span><span class="op">)</span>,</span>
<span>                                    data <span class="op">=</span> <span class="va">sample_occ_cropped</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette1_response_data_files/figure-html/example-spatiotemp_thin-1.png" width="384"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Thinned</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample_extent_data</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span></span>
<span><span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="va">occ_thin</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                    proj4string <span class="op">=</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +datum=WGS84 +no_defs"</span><span class="op">)</span>,</span>
<span>                                    data <span class="op">=</span> <span class="va">occ_thin</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette1_response_data_files/figure-html/example-spatiotemp_thin-2.png" width="384"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Plot the difference in temporal distribution after thinning</span></span>
<span></span>
<span><span class="va">thin_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">occ_thin</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span>, <span class="st">"%Y-%m-%d"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">og_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">sample_occ_cropped</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span>, <span class="st">"%Y-%m-%d"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="weight-records-by-sampling-effort">Weight records by sampling effort<a class="anchor" aria-label="anchor" href="#weight-records-by-sampling-effort"></a>
</h4>
<p>Another approach to account for spatiotemporal sampling biases is to weight records by sampling effort when fitting SDMs. This results in the down weighing of the importance of records from over-sampled regions and vice versa. Here, we will read in a sample of e-Bird avian sampling records in southern Africa to use as a sampling effort proxy, and sum these across a spatial and temporal buffer from each occurrence record using spatiotemp_weights().</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sample_events_data"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_occ_cropped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spatiotemp_weights.html">spatiotemp_weights</a></span><span class="op">(</span>occ.data <span class="op">=</span> <span class="va">sample_occ_cropped</span>,</span>
<span>                                       samp.events <span class="op">=</span> <span class="va">sample_events_data</span>,</span>
<span>                                       spatial.dist <span class="op">=</span> <span class="fl">100000</span>,</span>
<span>                                       temporal.dist <span class="op">=</span> <span class="fl">30</span>,</span>
<span>                                       prj <span class="op">=</span> <span class="st">"+proj=longlat +datum=WGS84"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Records completed: 100</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="e-generate-pseudo-absences-through-space-and-time">e) Generate pseudo-absences through space and time<a class="anchor" aria-label="anchor" href="#e-generate-pseudo-absences-through-space-and-time"></a>
</h3>
<p>Often the paucity of species absence records necessitates the generation of pseudo-absences, which are inferred absences based upon presence records. When modelling a species distribution at high spatiotemporal resolution, it may be best to generate pseudo-absences within close spatial and temporal buffers of species occurrence. This is because model presence-absence comparisons are made at fine scales, instead of coarsely between biomes and seasons. Using spatiotemp_pseudoabs() you can specify the spatial and temporal buffer size or extents to randomly generate pseudo-absences within.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pseudo-absences generated within spatial and temporal buffer</span></span>
<span><span class="va">pseudo_abs_buff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spatiotemp_pseudoabs.html">spatiotemp_pseudoabs</a></span><span class="op">(</span>occ.data <span class="op">=</span> <span class="va">sample_occ_cropped</span>,</span>
<span>                                        spatial.method <span class="op">=</span> <span class="st">"buffer"</span>,</span>
<span>                                        temporal.method <span class="op">=</span> <span class="st">"buffer"</span>,</span>
<span>                                        spatial.buffer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">250000</span>, <span class="fl">500000</span><span class="op">)</span>,</span>
<span>                                        temporal.buffer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">42</span>, <span class="fl">84</span><span class="op">)</span>,</span>
<span>                                        n.pseudoabs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sample_occ_cropped</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pseudo-absences generated randomly across given spatial and temporal extent</span></span>
<span><span class="va">pseudo_abs_rand</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spatiotemp_pseudoabs.html">spatiotemp_pseudoabs</a></span><span class="op">(</span>occ.data <span class="op">=</span> <span class="va">sample_occ_cropped</span>,</span>
<span>                                        spatial.method <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>                                        temporal.method <span class="op">=</span> <span class="st">"random"</span>,  </span>
<span>                                        spatial.ext <span class="op">=</span> <span class="va">sample_extent_data</span>,</span>
<span>                                        temporal.ext <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2002-01-01"</span>, <span class="st">"2019-12-01"</span><span class="op">)</span>,</span>
<span>                                        n.pseudoabs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sample_occ_cropped</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the spatial distribution of pseudo-absences (red) compared to occurrence records for:</span></span>
<span><span class="co"># Buffered</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample_extent_data</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span></span>
<span><span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="va">sample_occ_cropped</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                    proj4string <span class="op">=</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +datum=WGS84 +no_defs"</span><span class="op">)</span>,</span>
<span>                                    data <span class="op">=</span> <span class="va">sample_occ_cropped</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"black"</span>,add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="va">pseudo_abs_buff</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                    proj4string <span class="op">=</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +datum=WGS84 +no_defs"</span><span class="op">)</span>,</span>
<span>                                    data <span class="op">=</span> <span class="va">pseudo_abs_buff</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>,add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette1_response_data_files/figure-html/example-spatiotemp_pseudoabs-1.png" width="384"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Random</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample_extent_data</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span></span>
<span><span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="va">sample_occ_cropped</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                    proj4string <span class="op">=</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +datum=WGS84 +no_defs"</span><span class="op">)</span>,</span>
<span>                                    data <span class="op">=</span> <span class="va">sample_occ_cropped</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"black"</span>,add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="va">pseudo_abs_rand</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                    proj4string <span class="op">=</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +datum=WGS84 +no_defs"</span><span class="op">)</span>,</span>
<span>                                    data <span class="op">=</span> <span class="va">pseudo_abs_rand</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>,add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette1_response_data_files/figure-html/example-spatiotemp_pseudoabs-2.png" width="384"></p>
<p>Then, the generated pseudo-absences need to be added to the occurrence record data frame by adding relevant columns and binding the rows together.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pseudo_abs_buff</span><span class="op">$</span><span class="va">decimalLatitude</span> <span class="op">&lt;-</span> <span class="va">pseudo_abs_buff</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">pseudo_abs_buff</span><span class="op">$</span><span class="va">decimalLongitude</span> <span class="op">&lt;-</span> <span class="va">pseudo_abs_buff</span><span class="op">$</span><span class="va">x</span></span>
<span><span class="va">pseudo_abs_buff</span><span class="op">$</span><span class="va">occurrenceStatus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"absent"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pseudo_abs_buff</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pseudo_abs_buff</span><span class="op">$</span><span class="va">source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"dynamicSDM"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pseudo_abs_buff</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pseudo_abs_buff</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/spatiotemp_weights.html">spatiotemp_weights</a></span><span class="op">(</span>occ.data <span class="op">=</span> <span class="va">pseudo_abs_buff</span>,</span>
<span>                                       samp.events <span class="op">=</span> <span class="va">sample_events_data</span>,</span>
<span>                                       spatial.dist <span class="op">=</span> <span class="fl">100000</span>,</span>
<span>                                       temporal.dist <span class="op">=</span> <span class="fl">30</span>,</span>
<span>                                       prj <span class="op">=</span> <span class="st">"+proj=longlat +datum=WGS84"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">complete.dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">sample_occ_cropped</span>, <span class="va">pseudo_abs_buff</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>At the end of this vignette, we now have a complete data frame of filtered species occurrence and pseudo-absence records of appropriate spatiotemporal quality, extent and resolution. Let’s save this to our project directory for use in the next tutorial!</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">complete.dataset</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">project_directory</span>, <span class="st">"/filtered_quelea_occ.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Rachel Dobson, Andy J. Challinor, Robert A. Cheke, Stewart Jennings, Stephen G. Willis, Martin Dallimer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
