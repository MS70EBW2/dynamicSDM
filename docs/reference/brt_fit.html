<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit boosted regression tree models to species distribution or abundance data. — brt_fit • dynamicSDM</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit boosted regression tree models to species distribution or abundance data. — brt_fit"><meta property="og:description" content="Fit gradient boosting boosted regression tree models to species distribution and abundance data
and associated dynamic explanatory variables."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dynamicSDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/vig0.html">vig0</a>
    </li>
    <li>
      <a href="../articles/vignette1_response_data.html">dynamicSDM: Response variable data</a>
    </li>
    <li>
      <a href="../articles/vignette2_explanatory_data.html">dynamicSDM: Explanatory variable data</a>
    </li>
    <li>
      <a href="../articles/vignette3_modelling.html">dynamicSDM: model fitting and autocorrelation</a>
    </li>
    <li>
      <a href="../articles/vignette4_projecting.html">dynamicSDM: dynamic distribution projections</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit boosted regression tree models to species distribution or abundance data.</h1>
    
    <div class="hidden name"><code>brt_fit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit gradient boosting boosted regression tree models to species distribution and abundance data
and associated dynamic explanatory variables.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">brt_fit</span><span class="op">(</span></span>
<span>  <span class="va">occ.data</span>,</span>
<span>  <span class="va">response.col</span>,</span>
<span>  <span class="va">varnames</span>,</span>
<span>  <span class="va">distribution</span>,</span>
<span>  <span class="va">block.col</span>,</span>
<span>  <span class="va">weights.col</span>,</span>
<span>  <span class="va">test.data</span>,</span>
<span>  <span class="va">interaction.depth</span>,</span>
<span>  n.trees <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  shrinkage <span class="op">=</span> <span class="fl">0.001</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>occ.data</dt>
<dd><p>a data frame, the data to fit boosted regression tree models to, containing
columns for model response and explanatory variable data. If required, <code>occ.data</code> should contain
<code>block.col</code> and <code>weights.col</code> columns too.</p></dd>


<dt>response.col</dt>
<dd><p>a character string, the name of the column in <code>occ.data</code> containing response
variable column.</p></dd>


<dt>varnames</dt>
<dd><p>a character vector, the names of the columns containing model explanatory
variables in <code>occ.data.</code></p></dd>


<dt>distribution</dt>
<dd><p>a character string, the model distribution family to use, such as <code>gaussian</code>,
<code>poisson</code> or <code>bernoulli</code>.</p></dd>


<dt>block.col</dt>
<dd><p>optional; a character string, the name of the column in <code>occ.data</code> containing
spatiotemporal block numbers for <code>occ.data</code> splitting. See details for more information.</p></dd>


<dt>weights.col</dt>
<dd><p>a character string, the name of the column in <code>occ.data</code> containing
spatiotemporal sampling effort weights to be used in fitting process.</p></dd>


<dt>test.data</dt>
<dd><p>optional; a data frame, the testing dataset for optimising <code>interaction.depth</code> when
blocking is not used.</p></dd>


<dt>interaction.depth</dt>
<dd><p>optional; an integer specifying the maximum depth of each tree (i.e.
highest level of variable interactions allowed). Default optimises depth between 1 and 4.</p></dd>


<dt>n.trees</dt>
<dd><p>optional; an integer, the number of trees in boosted regression tree models.
Default is 5000.</p></dd>


<dt>shrinkage</dt>
<dd><p>optional; an integer, the shrinkage parameter applied to each tree in the boosted
regression tree expansion. Also known as learning rate. Default is 0.001.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns a <code>gbm</code> model object or list of <code>gbm</code> model objects.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function calculates a gradient boosting <code>gbm</code> object for the response and
explanatory variable data provided, using the <code>gbm</code> R package (Greenwell et al., 2019).</p>
<p>Key functionality for dynamic SDMs within <code>brt_fit()</code> includes:</p><ul><li><p>Optimise interaction.depth</p></li>
</ul><p>If <code>interaction.depth</code> is not given, then <code>brt_fit()</code> will vary the interaction depth parameter
between 1 (an additive model) and 4 (four-way interaction model). For each interaction.depth
value, model performance is measured by calculating the root-mean-square error of model
predictions compared to actual values in the testing data. The interaction.depth value that
results in the lowest root-mean-square error is used when fitting the returned model.</p>
<p>The model testing dataset can either be given using <code>test.data</code> or <code>block.col</code>
(latter expanded on below).</p><ul><li><p>Split by spatiotemporal blocks to account for spatial and temporal autocorrelation</p></li>
</ul><p>If <code>block.col</code> is specified, then each unique block is excluded in a jack-knife approach
following Bagchi et al., (2013). This approach uses each block as the model testing dataset in
numerical order, whilst all other <code>block.col</code> blocks are used as training data for the boosted
regression tree model.</p>
<p>In this case, the function returns a list of fitted boosted regression tree models equal to the
length of unique blocking categories in <code>block.col</code>.</p>
<p>If <code>block.col</code> is not given, models are fit to all occ.data and a single <code>gbm</code> model is
returned.</p><ul><li><p>Weighted by spatiotemporal sampling effort</p></li>
</ul><p>If <code>weights.col</code> is specified, records are weighted by their associated value in this column
when model fitting. For instance, the user may wish to down weigh the importance of records
collected at oversampled sites and times when fitting models, and vice versa, to account for
spatiotemporal biases in occurrence records.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Bagchi, R., Crosby, M., Huntley, B., Hole, D. G., Butchart, S. H. M., Collingham, Y.,
Kalra, M., Rajkumar, J., Rahmani, A. &amp; Pandey, M. 2013. Evaluating the effectiveness of
conservation site networks under climate change: accounting for uncertainty. Global Change
Biology, 19, 1236-1248. Greenwell, B., Boehmke, B., Cunningham, J., &amp; GBM Developers. 2019.
Package ‘gbm’. R package version, 2.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sample_explan_data"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sample_explan_data</span><span class="op">$</span><span class="va">weights</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">-</span><span class="va">sample_explan_data</span><span class="op">$</span><span class="va">REL_SAMP_EFFORT</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \dontshow{</span></span></span>
<span class="r-in"><span><span class="va">sample_filt_data</span><span class="op">&lt;-</span><span class="va">sample_explan_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               replace<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sample_explan_data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">training</span> <span class="op">&lt;-</span> <span class="va">sample_explan_data</span><span class="op">[</span><span class="va">split</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">testing</span> <span class="op">&lt;-</span> <span class="va">sample_explan_data</span><span class="op">[</span><span class="op">!</span><span class="va">split</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu">brt_fit</span><span class="op">(</span></span></span>
<span class="r-in"><span> occ.data <span class="op">=</span> <span class="va">training</span>,</span></span>
<span class="r-in"><span> test.data <span class="op">=</span> <span class="va">testing</span>,</span></span>
<span class="r-in"><span> response.col <span class="op">=</span> <span class="st">"presence.absence"</span>,</span></span>
<span class="r-in"><span> distribution <span class="op">=</span> <span class="st">"bernoulli"</span>,</span></span>
<span class="r-in"><span> weights.col <span class="op">=</span> <span class="st">"weights"</span>,</span></span>
<span class="r-in"><span> varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">training</span><span class="op">)</span><span class="op">[</span><span class="fl">14</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span>,</span></span>
<span class="r-in"><span> interaction.depth <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> block.col not specified. Model will be fit on all occ.data.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gbm::gbm(formula = formula, distribution = distribution, data = occ.data, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     weights = occ.data[, weights.col], n.trees = n.trees, interaction.depth = interaction.depth, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     shrinkage = shrinkage)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A gradient boosted model with bernoulli loss function.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5000 iterations were performed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There were 3 predictors of which 3 had non-zero influence.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rachel Dobson, Andy J. Challinor, Robert A. Cheke, Stewart Jennings, Stephen G. Willis, Martin Dallimer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

